/**
 * Injects the "Add Task" form markup into the overlay container.
 * @returns {string} Rendered HTML assigned to the form container.
 */
function loadAddTaskFormIntoOverlay() {
  const formContainer = document.getElementById("addTaskFormContainer");
  return formContainer.innerHTML = ` 
          <div class="center d-none">
          <div class="btn-priority btn-createTask popup-added"><Span>Task added to board</Span>
            <img src="..//assets/img/task.svg" alt="Task Logo">
          </div>
        </div>  
  <section class="add-task-content">
          <div class="wrapper">
            <h1 class="h1-content">Add Task
          <button class="close-overlay" onclick="closeAddTaskOverlay()">
            <img class="icon normal" src="../assets/img/close-icon.svg" alt="close">
            <img class="icon hover" src="../assets/img/close-hover.svg" alt="close hover">
          </button>
          </button></h1>
            <main class="main-content">
              <section class="card">
                <div>
                  <div class="field">
                    <label for="title">
                      Title<span class="required">*</span>
                    </label>
                    <input id="title" type="text" placeholder="Enter a title" class="input-Required">                    
                    <div class="invalid-feedback">This field is required.</div>
                  </div>
                </div>
                <div>
                  <div class="field">
                    <label for="description">Description</label>
                    <textarea id="description" placeholder="Enter a Description" style="height: 120px;"></textarea>
                  </div>
                </div>
                <div>
                  <div class="field">
                    <label>
                      Due date<span class="required">*</span>
                    </label>
                    <div>
                      <input class="input-icon-calender input-Required" id="duedate" type="date"
                        placeholder="dd/mm/yyyy" required>
                        <div class="invalid-feedback">This field is required.</div>
                    </div>
                  </div>
                </div>
              </section>
              <div class="center-seperator">
                <div class="seperator"></div>
              </div>
              <section class="card">
                <div class="div-field">
                  <div class="field">
                    <label class="field-label">Priority</label>
                    <div class="button-priority">
                      <input type="radio" id="prio-urgent" name="priority" value="urgent" class="prio-input">
                      <label for="prio-urgent" class="btn-priority btn-priority-flex">
                        Urgent
                        <svg width="20" height="15" viewBox="0 0 20 15" fill="#fff" xmlns="http://www.w3.org/2000/svg">
                          <g clip-path="url(#clip0_392603_5802)">
                            <path
                              d="M18.9043 14.5096C18.6696 14.51 18.4411 14.4351 18.2522 14.2961L10.0001 8.21288L1.74809 14.2961C1.63224 14.3816 1.50066 14.4435 1.36086 14.4783C1.22106 14.513 1.07577 14.5199 0.933305 14.4986C0.790837 14.4772 0.653973 14.428 0.530528 14.3538C0.407083 14.2796 0.299474 14.1818 0.213845 14.0661C0.128216 13.9503 0.0662437 13.8188 0.0314671 13.6791C-0.00330956 13.5394 -0.0102098 13.3943 0.0111604 13.2519C0.0543195 12.9644 0.21001 12.7058 0.443982 12.533L9.34809 5.96249C9.53679 5.8229 9.76536 5.74756 10.0001 5.74756C10.2349 5.74756 10.4635 5.8229 10.6522 5.96249L19.5563 12.533C19.7422 12.6699 19.8801 12.862 19.9503 13.0819C20.0204 13.3018 20.0193 13.5382 19.9469 13.7573C19.8746 13.9765 19.7349 14.1673 19.5476 14.3024C19.3604 14.4375 19.1352 14.51 18.9043 14.5096Z"
                              fill="#FF3D00" />
                            <path
                              d="M18.9043 8.76057C18.6696 8.76097 18.4411 8.68612 18.2522 8.54702L10.0002 2.46386L1.7481 8.54702C1.51412 8.71983 1.22104 8.79269 0.93331 8.74956C0.645583 8.70643 0.386785 8.55086 0.213849 8.31706C0.0409137 8.08326 -0.0319941 7.79039 0.011165 7.50288C0.054324 7.21536 0.210015 6.95676 0.443986 6.78395L9.3481 0.213471C9.5368 0.0738799 9.76537 -0.00146484 10.0002 -0.00146484C10.2349 -0.00146484 10.4635 0.0738799 10.6522 0.213471L19.5563 6.78395C19.7422 6.92087 19.8801 7.11298 19.9503 7.33286C20.0204 7.55274 20.0193 7.78914 19.947 8.00832C19.8746 8.22751 19.7349 8.41826 19.5476 8.55335C19.3604 8.68844 19.1352 8.76096 18.9043 8.76057Z"
                              fill="#FF3D00" />
                          </g>
                        </svg>
                      </label>
                      <input type="radio" id="prio-medium" name="priority" value="medium" class="prio-input" checked>
                      <label for="prio-medium" class="btn-priority btn-priority-flex">
                        Medium
                        <svg width="20" height="8" viewBox="0 0 20 8" fill="none" xmlns="http://www.w3.org/2000/svg">
                          <g clip-path="url(#clip0_156_994)">
                            <path
                              d="M18.9041 7.45086H1.09589C0.805242 7.45086 0.526498 7.33456 0.320979 7.12755C0.11546 6.92054 0 6.63977 0 6.34701C0 6.05425 0.11546 5.77349 0.320979 5.56647C0.526498 5.35946 0.805242 5.24316 1.09589 5.24316H18.9041C19.1948 5.24316 19.4735 5.35946 19.679 5.56647C19.8845 5.77349 20 6.05425 20 6.34701C20 6.63977 19.8845 6.92054 19.679 7.12755C19.4735 7.33456 19.1948 7.45086 18.9041 7.45086Z"
                              fill="#FFA800" />
                            <path
                              d="M18.9041 2.2077H1.09589C0.805242 2.2077 0.526498 2.0914 0.320979 1.88439C0.11546 1.67738 0 1.39661 0 1.10385C0 0.81109 0.11546 0.530322 0.320979 0.32331C0.526498 0.116298 0.805242 0 1.09589 0L18.9041 0C19.1948 0 19.4735 0.116298 19.679 0.32331C19.8845 0.530322 20 0.81109 20 1.10385C20 1.39661 19.8845 1.67738 19.679 1.88439C19.4735 2.0914 19.1948 2.2077 18.9041 2.2077Z"
                              fill="#FFA800" />
                          </g>
                        </svg>
                      </label>
                      <input type="radio" id="prio-low" name="priority" value="low" class="prio-input">
                      <label for="prio-low" class="btn-priority btn-priority-flex">
                        Low
                        <svg width="20" height="15" viewBox="0 0 20 15" fill="none" xmlns="http://www.w3.org/2000/svg">
                          <path
                            d="M10 8.76077C9.7654 8.76118 9.53687 8.68634 9.34802 8.54726L0.444913 1.97752C0.329075 1.89197 0.231235 1.78445 0.15698 1.66111C0.0827245 1.53777 0.033508 1.40102 0.0121402 1.25868C-0.031014 0.971193 0.0418855 0.678356 0.214802 0.444584C0.387718 0.210811 0.646486 0.0552534 0.934181 0.0121312C1.22188 -0.0309911 1.51493 0.0418545 1.74888 0.214643L10 6.29712L18.2511 0.214643C18.367 0.129087 18.4985 0.0671675 18.6383 0.0324205C18.7781 -0.00232646 18.9234 -0.00922079 19.0658 0.0121312C19.2083 0.0334832 19.3451 0.0826633 19.4685 0.156864C19.592 0.231064 19.6996 0.328831 19.7852 0.444584C19.8708 0.560336 19.9328 0.691806 19.9676 0.831488C20.0023 0.97117 20.0092 1.11633 19.9879 1.25868C19.9665 1.40102 19.9173 1.53777 19.843 1.66111C19.7688 1.78445 19.6709 1.89197 19.5551 1.97752L10.652 8.54726C10.4631 8.68634 10.2346 8.76118 10 8.76077Z"
                            fill="#7AE229" />
                          <path
                            d="M10 14.5093C9.7654 14.5097 9.53687 14.4349 9.34802 14.2958L0.444913 7.72606C0.210967 7.55327 0.0552944 7.29469 0.0121402 7.00721C-0.031014 6.71973 0.0418855 6.42689 0.214802 6.19312C0.387718 5.95935 0.646486 5.80379 0.934181 5.76067C1.22188 5.71754 1.51493 5.79039 1.74888 5.96318L10 12.0457L18.2511 5.96318C18.4851 5.79039 18.7781 5.71754 19.0658 5.76067C19.3535 5.80379 19.6123 5.95935 19.7852 6.19312C19.9581 6.42689 20.031 6.71973 19.9879 7.00721C19.9447 7.29469 19.789 7.55327 19.5551 7.72606L10.652 14.2958C10.4631 14.4349 10.2346 14.5097 10 14.5093Z"
                            fill="#7AE229" />
                        </svg>
                      </label>
                    </div>
                  </div>
                </div>
                <div class="div-field">
                  <div class="field">
                    <p>Assigned to </p>
                    <div class="contentwrapper">
                      <button type="button" id="BTNToggleContacts" onclick="toggleContacts()"
                        class="input-styling input-icon-arrow-down custom-select-select input-Required">Select
                        contacts to</button>
                    </div>
                    <div class="d-flex">
                      <div class="input-wrapper">
                        <input type="text" id="searchContacts" oninput="contactSearch()" placeholder="Search..."
                          class="d-none">
                        <button id="closeAssigned" class="d-none input-icon-arrow-up"
                          onclick="closeAssigned()"></button>
                      </div>
                      <div id="selectContacts" class="dropdown category-main"></div>
                    </div>
                    <div class="selectContact" id="selectContact"></div>
                    </div>
                  </div>
                <div class="div-field">
                  <div class="field">
                    <label for="categoryBtn">
                      Category<span class="required">*</span>
                    </label>
                    <button type="button" id="categoryBtn"
                      class="input-styling input-icon-arrow-down custom-select-select input-Required"
                      onclick="toggleCategory(),onblur=categorySelectorCheck()" >
                      Select task category
                    </button>
                    <div id="selectCategory" class="dropdown">
                      <div class="category-main">
                        <input type="radio" id="TechnicalTask" name="priorityCategory" value="Technical Task"
                          onclick="categorySelector()" />
                        <label for="TechnicalTask" class="contact-row">Technical Task</label>
                        <input type="radio" id="UserStory" name="priorityCategory" value="User Story"
                          onclick="categorySelector()" />
                        <label for="UserStory" class="contact-row">User Story</label>
                        
                      </div>
                    </div>
                    <div id="errorCategory" class="invalid-feedback">This field is required.</div>
                  </div>
                </div>
                  <div class="div-field">
                    <div class="field">
                      <label for="subtasks">Subtasks</label>
                      <div class="subtask-input-container">
                        <div class="input-wrapper">
                          <input id="subtasks" type="text" onclick="createSubtasks()" placeholder="Add new subtask">
                          <div class="img-container" id="showHiddenSubtasks">
                            <img src="../assets/img/Subtasks cancel.svg" class="input-icon-cancel"
                              onclick="cancelSubtask()">
                            <div class="seperator-small"></div>
                            <img src="../assets/img/Subtasks accept.svg" class="input-icon-accept"
                              onclick="addSubtask()">
                          </div>
                        </div>
                      </div>
                      <div id="SubtaskList" class="Subtask-List">
                      </div>
                    </div>
                  </div>
              </section>
            </main>
            <section class="footer-add-task">
              <p class="required">*
                <span style="color: #000000;">This field is required</span>
              </p>
              <div class="btn-priority-flex footerBtn-priority">
                <div class="footer-flex">
                  <button class="btn-priority  btn-clear" onclick="clearInputs()">Clear
                    <svg width="11" height="11" viewBox="0 0 13 13" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path
                        d="M6.243 6.243L11.486 11.486M1 11.486L6.243 6.243L1 11.486ZM11.486 1L6.242 6.243L11.486 1ZM6.242 6.243L1 1L6.242 6.243Z"
                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                  </button>
                  <button class="btn-createTask btn-priority-flex btn-State" id="colorChange"
                    onclick="CreateTask()" disabled >Create Task
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="#29ABE2" xmlns="http://www.w3.org/2000/svg">
                      <mask id="mask0_411527_6018" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0"
                        width="24" height="24">
                        <rect width="24" height="24" fill="#D9D9D9" />
                      </mask>
                      <g mask="url(#mask0_411527_6018)">
                        <path
                          d="M9.55069 15.15L18.0257 6.675C18.2257 6.475 18.4632 6.375 18.7382 6.375C19.0132 6.375 19.2507 6.475 19.4507 6.675C19.6507 6.875 19.7507 7.1125 19.7507 7.3875C19.7507 7.6625 19.6507 7.9 19.4507 8.1L10.2507 17.3C10.0507 17.5 9.81736 17.6 9.55069 17.6C9.28403 17.6 9.05069 17.5 8.85069 17.3L4.5507 13C4.3507 12.8 4.25486 12.5625 4.2632 12.2875C4.27153 12.0125 4.3757 11.775 4.5757 11.575C4.7757 11.375 5.0132 11.275 5.2882 11.275C5.5632 11.275 5.80069 11.375 6.00069 11.575L9.55069 15.15Z"
                          fill="white" />
                      </g>
                    </svg></button>
                </div>
              </div>
          </div>
        </section>
    `;
}

/**
 * Creates the HTML for the task details overlay.
 * @param {import("./add-task.js").TaskPayload|any} task
 * @param {string} taskID
 * @returns {string}
 */
function taskPopup(task, taskID) {
  return `<div class="detail-card">
    <div class="detail-header">
      <div class="tag ${filterCategory(task.category)}">${task.category}</div>
      
        <button class="close-overlay" onclick="closetaskDetailsOverlay()">
        <img class="icon normal" src="../assets/img/close-icon.svg" alt="close">
        <img class="icon hover" src="../assets/img/close-hover.svg" alt="close hover">
      </button>
    </div>
    <h2 class="detail-title">${task.title}</h2>
    <p class="detail-description">${task.description}</p>
    <div class="detail-info-row">
      <span class="detail-label">Due date:</span>
      <span class="detail-value">${dateStringChange(task.duedate)}</span>
    </div>
    <div class="detail-info-row">
      <span class="detail-label">Priority:</span>
      <div class="detail-value-prio">${capitalizeLetters(task.priority)}</div>
      <div class="${filterPriority(task.priority)} prio-wrapper"></div>
    </div>
    <div class="detail-section">
      <span class="detail-label">Assigned To:</span>
      <div class="assignee-list">
        <div class="assignee-item">${renderTaskContactDetails(task.contacts)}</div>
      </div>
    </div>
    <div class="detail-section">
      <span class="detail-label">Subtasks</span>
      <div class="subtask-list">
        ${renderTaskSubTaskDetails(taskID)}
      </div>
    </div>
    <div class="detail-footer">
      <button class="action-btn" onclick=deleteTaskOnBoard('${taskID}')>
        <img src="../assets/img/SubTask delete.svg" alt=""> Delete
      </button>
      <div class="footer-separator"></div>
      <button class="action-btn" onclick="editTaskOnBoard('${taskID}')">
        <img src="../assets/img/edit-contact.svg" alt=""> Edit
      </button>
    </div>
  </div>
    `;
}

/**
 * Creates the HTML for the task edit overlay.
 * @param {import("./add-task.js").TaskPayload|any} task
 * @param {string} id
 * @returns {string}
 */
function taskPopupEditMode(task, id) {
  console.dir(task);

  const isUrgent = task.priority === "urgent" ? "checked" : "";
  const isMedium = task.priority === "medium" ? "checked" : "";
  const isLow = task.priority === "low" ? "checked" : "";
  return `<div class="overlay-content">
  <section class="add-task-content">
    <div class="edit-mode-popup">
      <div class="edit-header">
        <h1 class="h1-content edit">Edit Task</h1>
        <button class="close-overlay" onclick="closetaskDetailsOverlay()">
        <img class="icon normal" src="../assets/img/close-icon.svg" alt="close">
        <img class="icon hover" src="../assets/img/close-hover.svg" alt="close hover">
        </button>
      </div>
      <main class="main-content">
        <section class="card">
                  <div class="field">
                    <label for="title">
                      Title<span class="required"></span>
                    </label>
                    <input id="title" type="text" placeholder = "${task.title}"class="input-Required" >                    
                    <div class="invalid-feedback">This field is required.</div>
                  </div>
          <div class="field">
            <label for="description">Description</label>
            <textarea id="description" style="height: 120px;" placeholder="${task.description}"></textarea>
          </div>
                    <div>
                      <input class="input-icon-calender input-Required" id="duedate" type="date"
                        placeholder="${task.duedate}" required>
                        <div class="invalid-feedback">This field is required.</div>
                    </div>
        </section>
        <div class="center-seperator">
          <div class="seperator"></div>
        </div>
        <section class="card">
          <div class="field">
            <label class="field-label">Priority</label>
            <div class="button-priority">
              <input type="radio" id="prio-urgent" name="priority" value="urgent" class="prio-input d-none" ${isUrgent}>
              <label for="prio-urgent" class="btn-priority btn-priority-flex">
                Urgent <svg width="20" height="15" viewBox="0 0 20 15" fill="#fff" xmlns="http://www.w3.org/2000/svg">
                  <g clip-path="url(#clip0_392603_5802)">
                    <path d="M18.9043 14.5096C18.6696 14.51 18.4411 14.4351 18.2522 14.2961L10.0001 8.21288L1.74809 14.2961C1.63224 14.3816 1.50066 14.4435 1.36086 14.4783C1.22106 14.513 1.07577 14.5199 0.933305 14.4986C0.790837 14.4772 0.653973 14.428 0.530528 14.3538C0.407083 14.2796 0.299474 14.1818 0.213845 14.0661C0.128216 13.9503 0.0662437 13.8188 0.0314671 13.6791C-0.00330956 13.5394 -0.0102098 13.3943 0.0111604 13.2519C0.0543195 12.9644 0.21001 12.7058 0.443982 12.533L9.34809 5.96249C9.53679 5.8229 9.76536 5.74756 10.0001 5.74756C10.2349 5.74756 10.4635 5.8229 10.6522 5.96249L19.5563 12.533C19.7422 12.6699 19.8801 12.862 19.9503 13.0819C20.0204 13.3018 20.0193 13.5382 19.9469 13.7573C19.8746 13.9765 19.7349 14.1673 19.5476 14.3024C19.3604 14.4375 19.1352 14.51 18.9043 14.5096Z" fill="#FF3D00" />
                    <path d="M18.9043 8.76057C18.6696 8.76097 18.4411 8.68612 18.2522 8.54702L10.0002 2.46386L1.7481 8.54702C1.51412 8.71983 1.22104 8.79269 0.93331 8.74956C0.645583 8.70643 0.386785 8.55086 0.213849 8.31706C0.0409137 8.08326 -0.0319941 7.79039 0.011165 7.50288C0.054324 7.21536 0.210015 6.95676 0.443986 6.78395L9.3481 0.213471C9.5368 0.0738799 9.76537 -0.00146484 10.0002 -0.00146484C10.2349 -0.00146484 10.4635 0.0738799 10.6522 0.213471L19.5563 6.78395C19.7422 6.92087 19.8801 7.11298 19.9503 7.33286C20.0204 7.55274 20.0193 7.78914 19.947 8.00832C19.8746 8.22751 19.7349 8.41826 19.5476 8.55335C19.3604 8.68844 19.1352 8.76096 18.9043 8.76057Z" fill="#FF3D00" />
                  </g>
                </svg>
              </label>
              <input type="radio" id="prio-medium" name="priority" value="medium" class="prio-input d-none" ${isMedium}>
              <label for="prio-medium" class="btn-priority btn-priority-flex #prio-medium:">
                Medium <svg width="20" height="8" viewBox="0 0 20 8" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <g clip-path="url(#clip0_156_994)">
                    <path d="M18.9041 7.45086H1.09589C0.805242 7.45086 0.526498 7.33456 0.320979 7.12755C0.11546 6.92054 0 6.63977 0 6.34701C0 6.05425 0.11546 5.77349 0.320979 5.56647C0.526498 5.35946 0.805242 5.24316 1.09589 5.24316H18.9041C19.1948 5.24316 19.4735 5.35946 19.679 5.56647C19.8845 5.77349 20 6.05425 20 6.34701C20 6.63977 19.8845 6.92054 19.679 7.12755C19.4735 7.33456 19.1948 7.45086 18.9041 7.45086Z" fill="#FFA800" />
                    <path d="M18.9041 2.2077H1.09589C0.805242 2.2077 0.526498 2.0914 0.320979 1.88439C0.11546 1.67738 0 1.39661 0 1.10385C0 0.81109 0.11546 0.530322 0.320979 0.32331C0.526498 0.116298 0.805242 0 1.09589 0L18.9041 0C19.1948 0 19.4735 0.116298 19.679 0.32331C19.8845 0.530322 20 0.81109 20 1.10385C20 1.39661 19.8845 1.67738 19.679 1.88439C19.4735 2.0914 19.1948 2.2077 18.9041 2.2077Z" fill="#FFA800" />
                  </g>
                </svg>
              </label>
              <input type="radio" id="prio-low" name="priority" value="low" class="prio-input d-none" ${isLow}>
              <label for="prio-low" class="btn-priority btn-priority-flex">
                Low <svg width="20" height="15" viewBox="0 0 20 15" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M10 8.76077C9.7654 8.76118 9.53687 8.68634 9.34802 8.54726L0.444913 1.97752C0.329075 1.89197 0.231235 1.78445 0.15698 1.66111C0.0827245 1.53777 0.033508 1.40102 0.0121402 1.25868C-0.031014 0.971193 0.0418855 0.678356 0.214802 0.444584C0.387718 0.210811 0.646486 0.0552534 0.934181 0.0121312C1.22188 -0.0309911 1.51493 0.0418545 1.74888 0.214643L10 6.29712L18.2511 0.214643C18.367 0.129087 18.4985 0.0671675 18.6383 0.0324205C18.7781 -0.00232646 18.9234 -0.00922079 19.0658 0.0121312C19.2083 0.0334832 19.3451 0.0826633 19.4685 0.156864C19.592 0.231064 19.6996 0.328831 19.7852 0.444584C19.8708 0.560336 19.9328 0.691806 19.9676 0.831488C20.0023 0.97117 20.0092 1.11633 19.9879 1.25868C19.9665 1.40102 19.9173 1.53777 19.843 1.66111C19.7688 1.78445 19.6709 1.89197 19.5551 1.97752L10.652 8.54726C10.4631 8.68634 10.2346 8.76118 10 8.76077Z" fill="#7AE229" />
                  <path d="M10 14.5093C9.7654 14.5097 9.53687 14.4349 9.34802 14.2958L0.444913 7.72606C0.210967 7.55327 0.0552944 7.29469 0.0121402 7.00721C-0.031014 6.71973 0.0418855 6.42689 0.214802 6.19312C0.387718 5.95935 0.646486 5.80379 0.934181 5.76067C1.22188 5.71754 1.51493 5.79039 1.74888 5.96318L10 12.0457L18.2511 5.96318C18.4851 5.79039 18.7781 5.71754 19.0658 5.76067C19.3535 5.80379 19.6123 5.95935 19.7852 6.19312C19.9581 6.42689 20.031 6.71973 19.9879 7.00721C19.9447 7.29469 19.789 7.55327 19.5551 7.72606L10.652 14.2958C10.4631 14.4349 10.2346 14.5097 10 14.5093Z" fill="#7AE229" />
                </svg>
              </label>
            </div>
          </div>
          <div class="field">
            <p>Assigned to </p>
            <div class="contentwrapper">
              <button type="button" id="BTNToggleContacts" onclick="toggleContacts()"
                class="input-styling input-icon-arrow-down custom-select-select input-Required">Select contacts to</button>
            </div>
            <div class="d-flex">
              <div class="input-wrapper">
                <input type="text" id="searchContacts" oninput="contactSearch()" placeholder="Search..." class="d-none">
                <button id="closeAssigned" class="d-none input-icon-arrow-up" onclick="closeAssigned()"></button>
              </div>
              <div id="selectContacts" class="dropdown category-main"></div>
            </div>
            <div class="selectContact" id="selectContact"></div>
          </div>
            <div class="div-field">
              <div class="field">
                <label for="categoryBtn">
                  Category<span class="required">*</span>
                </label>
                    <button type="button" id="categoryBtn"
                      class="input-styling input-icon-arrow-down custom-select-select input-Required"
                      onclick="toggleCategory()" onblur=categorySelectorCheck() >
                      ${task.category}
                    </button>
                      <div id="selectCategory" class="dropdown">
                        <div class="category-main">
                          <input type="radio" id="TechnicalTask" name="priorityCategory" value="Technical Task"
                            onclick="categorySelector()" />
                          <label for="TechnicalTask" class="contact-row">Technical Task</label>
                          <input type="radio" id="UserStory" name="priorityCategory" value="User Story"
                            onclick="categorySelector()" />
                          <label for="UserStory" class="contact-row">User Story</label>
                        </div>
                      </div>
                    </div>
                  </div>
          <div class="div-field">
            <div class="field">
              <label for="subtasks">Subtasks</label>
              <div class="subtask-input-container">
                <div class="input-wrapper">
                  <input id="subtasks" type="text" onclick="createSubtasks()" placeholder="Add new subtask">
                  <div class="img-container" id="showHiddenSubtasks">
                    <img src="../assets/img/Subtasks cancel.svg" class="input-icon-cancel" onclick="cancelSubtask()">
                    <div class="seperator-small"></div>
                    <img src="../assets/img/Subtasks accept.svg" class="input-icon-accept" onclick="addSubtask()">
                  </div>
                </div>
              </div>
              <div id="SubtaskList" class="Subtask-List"></div>              
            </div>
          </div>  
        </section>
      </main>
      <section class="footer-add-task edit">
        <p class="required">*
                <span style="color: #000000;">This field is required</span>
              </p>
        <div class="footer-flex">
          <button class="btn-createTask btn-priority-flex" onclick="saveEditedTask('${id}')">
            Ok <img src="../assets/img/create-contact-check.svg" alt="check">
          </button>
        </div>
      </section>
    </div>
  </section>
  </div>
  `;
}

/**
 * Builds HTML for one editable subtask row in edit mode.
 * @param {{title: string, state?: string}} subtask
 * @param {number} i
 * @param {string} id
 * @returns {string}
 */
function renderSubtasksDetailsEditHTML(subtask, i, id) {
  return `<div class="sub-container" data-index="${i}">
    <span class="display-flex">â€¢ ${subtask.title}</span>
    <div class="hover-show">
      <img src="../assets/img/Subtasks change.svg" class="input-icon-cancel" onclick="editChangeSubtask('${id}', ${i})">
        <div class="seperator-small"></div>
        <img src="../assets/img/SubTask delete.svg" class="input-icon-accept" onclick="editDeleteSubtask('${id}', ${i})">
        </div>
    </div>`;
}

/**
 * Renders the HTML for a task card on the board.
 * @param {import("./add-task.js").TaskPayload|any} task
 * @param {string} id
 * @returns {string}
 */
function renderTasksHTML(task, id) {
  const stats = getSubtaskStats(task)
  return `<div class="cards" data-id="${id}" draggable="true" ondragstart="onDragStart(event)" ondragend="onDragEnd(event)" onclick="openTaskDetailsOverlay(this)">                 
                  <p class="tag ${filterCategory(task.category)}">${task.category}</p>   
                  <h4>${task.title}</h4>
                  <span>${task.description}</span>
                  <div class="progress">${stats.checked} / ${stats.total}Subtasks</div>
                  <div class ="nav">
                  <div class="avatars">${renderTaskContact(task.contacts)}</div>
                  <div class="${filterPriority(task.priority)} prio-wrapper"></div>            
                  </div>
                  </div>
                </div>     
  `;
}

/**
 * Builds HTML for a contact avatar badge.
 * @param {{color: string, initials: string}} contact
 * @returns {string}
 */
function renderContactAvatarHTML(contact) {
  return `<div class="avatar" style="background-color:${contact.color}">
      ${contact.initials}
    </div>
    `;
}

/**
 * Builds HTML for a single subtask item in the details view.
 * @param {{title: string, state: "check"|"uncheck"}} subtask
 * @param {number} i
 * @param {string} taskId
 * @returns {string}
 */
function renderTaskSubTaskDetailsHTML(subtask, i, taskId) {
  const isChecked = subtask.state === "check" ? "checked" : "";
  return `<div class="subtask-item">
        <input class="checkbox-input-subtask" type="checkbox" id="subtask-${taskId}-${i}" onchange="toggleSubtask('${taskId}', ${i})" ${isChecked}>
        <label for="subtask-${taskId}-${i}">${subtask.title}</label>
      </div>`;
}

/**
 * Builds HTML for a single assigned contact detail entry.
 * @param {{color: string, initials: string, name: string}} contact
 * @returns {string}
 */
function renderTaskContactDetailsHTML(contact) {
  return `<div class="assignee-item">
          <section class="contact-section">
          <div class="initials-circle" style="background-color: ${contact.color}">${contact.initials}</div>          
          <p>${contact.name}</p>
          </section>
        </div>`;
}
